<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.avengers.musinsa.mapper.CategoryMapper">

    <select id="getCategoryProductList"
            resultType="com.avengers.musinsa.domain.category.dto.response.CategoryProductResponse">
        SELECT pc.product_category_id        AS productCategoryId,
               pc.parent_product_category_id AS parentProductCategoryId,
               pc.category_name              AS categoryName,
               pc.category_image             AS categoryImage,
               pc.category_level             AS categoryLevel
        FROM product_categories pc
        <if test="parentCategoryId != null">
            WHERE pc.parent_product_category_id = #{parentCategoryId}
        </if>
        ORDER BY product_category_id
    </select>

    <!--카테고리 - 브랜드 목록 전체 조회-->
    <select id="getBrandList"
            resultType="com.avengers.musinsa.domain.brand.dto.response.BrandResponse">
        SELECT brand_id as brandId,
               brand_name_kr as brandNameKr,
               brand_name_eng as brandNameEn,
               brand_image as brandImage,
               brand_likes as brandLikes
        FROM brands
        ORDER BY BRAND_LIKES DESC, brand_name_kr ASC
    </select>

    <!--카테고리 - 카테고리 별로 브랜드 목록 조회-->
    <select id="getBrandsByCategoryId"
            resultType="com.avengers.musinsa.domain.category.dto.response.BrandByCategoryResponse">
        SELECT bc.brand_category_id as brandCategoryId,
               bc.category_name as categoryName,
               b.brand_id as brandId,
               b.brand_name_kr as brandNameKr,
               b.brand_name_eng as brandNameEn,
               b.brand_image as brandImage
        FROM brands b
                 JOIN brand_has_categories bhc ON b.BRAND_ID = bhc.BRAND_ID
                 JOIN brand_categories bc ON bc.brand_category_id = bhc.brand_category_id
        WHERE bc.BRAND_CATEGORY_ID = #{categoryID}
        ORDER BY BRAND_LIKES DESC, brand_name_kr ASC
    </select>

    <select id="findBrandsByEnglishFirstLetter"
            resultType="com.avengers.musinsa.domain.brand.dto.response.BrandResponse">
        SELECT brand_id as brandId,
               brand_name_kr as brandNameKr,
               brand_name_eng as brandNameEn,
               brand_image as brandImage,
               brand_likes as brandLikes
        FROM brands
        WHERE brand_name_eng LIKE CONCAT(#{brandFirstLetter}, '%')
        ORDER BY brand_name_eng
    </select>

    <select id="findBrandsByKoreanFirstLetter"
            resultType="com.avengers.musinsa.domain.brand.dto.response.BrandResponse">
        SELECT brand_id as brandId,
               brand_name_kr as brandNameKr,
               brand_name_eng as brandNameEn,
               brand_image as brandImage,
               brand_likes as brandLikes
        FROM brands
        WHERE brand_first_letter_kr = #{brandFirstLetter}
        ORDER BY brand_name_kr
    </select>
</mapper>
